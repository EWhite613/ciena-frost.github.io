FROM artifactory.ciena.com/blueplanet/frost-ci-base:0.2.0

ENV DISPLAY=:0 \
    VCS_USERNAME=teamcity \
    VCS_PASSWORD=:7dwt0#ineq67Z
    
WORKDIR /bp2/src

# Separate the . install to short the image build time
COPY . /bp2/src

# Setup git environment
RUN git config --global user.email "teamcity@ciena.com" &&     git config --global user.name "teamcity"

RUN mv .ci-env/nenv /usr/local/bin/nenv && \
    mv .ci-env/.tsdrc /root/.tsdrc && \
    mkdir /root/.ssh && \
    mv .ci-env/id_rsa /root/.ssh/id_rsa && \
    mv .ci-env/id_rsa.pub /root/.ssh/id_rsa.pub && \
    mv .ci-env/config /root/.ssh/config && \
    mv .ci-env/known_hosts /root/.ssh/known_hosts && \
    mv .ci-env/sonar-runner.properties /usr/local/sonar-runner-2.4/conf
